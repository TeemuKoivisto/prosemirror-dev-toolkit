import{r as o,n as v}from"./index.9fc99642.js";import{I as m}from"./idle-scheduler.328c9af7.js";function l(e,r,n,t,i,f,u){try{var s=e[f](u),a=s.value}catch(h){n(h);return}s.done?r(a):Promise.resolve(a).then(t,i)}function w(e){return function(){var r=this,n=arguments;return new Promise(function(t,i){var f=e.apply(r,n);function u(a){l(f,t,i,u,s,"next",a)}function s(a){l(f,t,i,u,s,"throw",a)}u(void 0)})}}function g(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function c(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function p(e,r,n){return r&&c(e.prototype,r),n&&c(e,n),e}function d(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}var k=function(){function e(r){var n=this;g(this,e),d(this,"queue",new Map),d(this,"scheduler",new m),this.worker=r,this.worker.addEventListener("message",function(t){var i=n.queue.get(t.data.id);i&&(n.queue.delete(t.data.id),i.resolve(t.data.returns))})}return p(e,[{key:"diff",value:function(){var r=w(o.mark(function t(i){var f,u;return o.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.scheduler.request();case 2:return f=v(),u=y(),this.queue.set(f,u),this.worker.postMessage({method:"diff",id:f,args:[i]}),a.abrupt("return",u);case 7:case"end":return a.stop()}},t,this)}));function n(t){return r.apply(this,arguments)}return n}()}]),e}();function y(){var e,r=new Promise(function(n){e=n});return r.resolve=function(){return e.apply(void 0,arguments)},r}export{k as JsonDiffWorker};
