import{n as H}from"./index-dffb0482.js";import{I as K}from"./idle-scheduler-7aa0dcbd.js";function M(a){return M=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u},M(a)}function C(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */C=function(){return a};var a={},u=Object.prototype,f=u.hasOwnProperty,c=Object.defineProperty||function(e,t,r){e[t]=r.value},d=typeof Symbol=="function"?Symbol:{},v=d.iterator||"@@iterator",y=d.asyncIterator||"@@asyncIterator",g=d.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch{s=function(r,n,o){return r[n]=o}}function E(e,t,r,n){var o=t&&t.prototype instanceof T?t:T,i=Object.create(o.prototype),h=new q(n||[]);return c(i,"_invoke",{value:z(e,r,h)}),i}function P(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(n){return{type:"throw",arg:n}}}a.wrap=E;var m={};function T(){}function S(){}function b(){}var I={};s(I,v,function(){return this});var N=Object.getPrototypeOf,O=N&&N(N(A([])));O&&O!==u&&f.call(O,v)&&(I=O);var k=b.prototype=T.prototype=Object.create(I);function W(e){["next","throw","return"].forEach(function(t){s(e,t,function(r){return this._invoke(t,r)})})}function G(e,t){function r(o,i,h,l){var p=P(e[o],e,i);if(p.type!=="throw"){var L=p.arg,w=L.value;return w&&M(w)=="object"&&f.call(w,"__await")?t.resolve(w.__await).then(function(_){r("next",_,h,l)},function(_){r("throw",_,h,l)}):t.resolve(w).then(function(_){L.value=_,h(L)},function(_){return r("throw",_,h,l)})}l(p.arg)}var n;c(this,"_invoke",{value:function(i,h){function l(){return new t(function(p,L){r(i,h,p,L)})}return n=n?n.then(l,l):l()}})}function z(e,t,r){var n="suspendedStart";return function(o,i){if(n==="executing")throw new Error("Generator is already running");if(n==="completed"){if(o==="throw")throw i;return J()}for(r.method=o,r.arg=i;;){var h=r.delegate;if(h){var l=Y(h,r);if(l){if(l===m)continue;return l}}if(r.method==="next")r.sent=r._sent=r.arg;else if(r.method==="throw"){if(n==="suspendedStart")throw n="completed",r.arg;r.dispatchException(r.arg)}else r.method==="return"&&r.abrupt("return",r.arg);n="executing";var p=P(e,t,r);if(p.type==="normal"){if(n=r.done?"completed":"suspendedYield",p.arg===m)continue;return{value:p.arg,done:r.done}}p.type==="throw"&&(n="completed",r.method="throw",r.arg=p.arg)}}}function Y(e,t){var r=e.iterator[t.method];if(r===void 0){if(t.delegate=null,t.method==="throw"){if(e.iterator.return&&(t.method="return",t.arg=void 0,Y(e,t),t.method==="throw"))return m;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var n=P(r,e.iterator,t.arg);if(n.type==="throw")return t.method="throw",t.arg=n.arg,t.delegate=null,m;var o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,t.method!=="return"&&(t.method="next",t.arg=void 0),t.delegate=null,m):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function B(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function q(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(B,this),this.reset(!0)}function A(e){if(e){var t=e[v];if(t)return t.call(e);if(typeof e.next=="function")return e;if(!isNaN(e.length)){var r=-1,n=function o(){for(;++r<e.length;)if(f.call(e,r))return o.value=e[r],o.done=!1,o;return o.value=void 0,o.done=!0,o};return n.next=n}}return{next:J}}function J(){return{value:void 0,done:!0}}return S.prototype=b,c(k,"constructor",{value:b,configurable:!0}),c(b,"constructor",{value:S,configurable:!0}),S.displayName=s(b,g,"GeneratorFunction"),a.isGeneratorFunction=function(e){var t=typeof e=="function"&&e.constructor;return!!t&&(t===S||(t.displayName||t.name)==="GeneratorFunction")},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,s(e,g,"GeneratorFunction")),e.prototype=Object.create(k),e},a.awrap=function(e){return{__await:e}},W(G.prototype),s(G.prototype,y,function(){return this}),a.AsyncIterator=G,a.async=function(e,t,r,n,o){o===void 0&&(o=Promise);var i=new G(E(e,t,r,n),o);return a.isGeneratorFunction(t)?i:i.next().then(function(h){return h.done?h.value:i.next()})},W(k),s(k,g,"Generator"),s(k,v,function(){return this}),s(k,"toString",function(){return"[object Generator]"}),a.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function o(){for(;r.length;){var i=r.pop();if(i in t)return o.value=i,o.done=!1,o}return o.done=!0,o}},a.values=A,q.prototype={constructor:q,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!t)for(var r in this)r.charAt(0)==="t"&&f.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if(t.type==="throw")throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(L,w){return h.type="throw",h.arg=t,r.next=L,w&&(r.method="next",r.arg=void 0),!!w}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],h=i.completion;if(i.tryLoc==="root")return n("end");if(i.tryLoc<=this.prev){var l=f.call(i,"catchLoc"),p=f.call(i,"finallyLoc");if(l&&p){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!p)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,r){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&f.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&(t==="break"||t==="continue")&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var h=i?i.completion:{};return h.type=t,h.arg=r,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(h)},complete:function(t,r){if(t.type==="throw")throw t.arg;return t.type==="break"||t.type==="continue"?this.next=t.arg:t.type==="return"?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):t.type==="normal"&&r&&(this.next=r),m},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),j(n),m}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc===t){var o=n.completion;if(o.type==="throw"){var i=o.arg;j(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:A(t),resultName:r,nextLoc:n},this.method==="next"&&(this.arg=void 0),m}},a}function R(a,u,f,c,d,v,y){try{var g=a[v](y),s=g.value}catch(E){f(E);return}g.done?u(s):Promise.resolve(s).then(c,d)}function Q(a){return function(){var u=this,f=arguments;return new Promise(function(c,d){var v=a.apply(u,f);function y(s){R(v,c,d,y,g,"next",s)}function g(s){R(v,c,d,y,g,"throw",s)}y(void 0)})}}function U(a,u){if(!(a instanceof u))throw new TypeError("Cannot call a class as a function")}function $(a,u){for(var f=0;f<u.length;f++){var c=u[f];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}}function V(a,u,f){return u&&$(a.prototype,u),f&&$(a,f),Object.defineProperty(a,"prototype",{writable:!1}),a}function D(a,u,f){return u in a?Object.defineProperty(a,u,{value:f,enumerable:!0,configurable:!0,writable:!0}):a[u]=f,a}var x=function(){function a(u){var f=this;U(this,a),D(this,"queue",new Map),D(this,"scheduler",new K),D(this,"worker",void 0),this.worker=u,this.worker.addEventListener("message",function(c){var d=f.queue.get(c.data.id);d&&(f.queue.delete(c.data.id),d.resolve(c.data.returns))})}return V(a,[{key:"diff",value:function(){var u=Q(C().mark(function c(d){var v,y;return C().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.scheduler.request();case 2:return v=H(),y=X(),this.queue.set(v,y),this.worker.postMessage({method:"diff",id:v,args:[d]}),s.abrupt("return",y);case 7:case"end":return s.stop()}},c,this)}));function f(c){return u.apply(this,arguments)}return f}()}]),a}();function X(){var a,u=new Promise(function(f){a=f});return u.resolve=function(){return a.apply(void 0,arguments)},u}export{x as JsonDiffWorker};
